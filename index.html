<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>AI Video Popup Engine</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <style>
    body {
      margin: 0;
      font-family: monospace;
      background-color: #000;
      color: #0f0;
      padding: 20px;
    }

    h1 {
      text-align: center;
    }

    input, button {
      padding: 10px;
      background: #111;
      color: #0f0;
      border: 1px solid #0f0;
      margin: 5px;
    }

    button:hover {
      background: #0f0;
      color: #000;
    }

    .popup {
      position: fixed;
      width: 50vw;
      height: 50vh;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      background: #111;
      border: 2px solid #0f0;
      z-index: 1000;
      box-shadow: 0 0 20px #0f0;
      display: flex;
      flex-direction: column;
      animation: fadeIn 0.5s ease-out;
    }

    .popup iframe {
      flex: 1;
      width: 100%;
      border: none;
    }

    .caption {
      background: #000;
      color: #0f0;
      padding: 5px;
      font-size: 14px;
      border-top: 1px solid #0f0;
    }

    .close-btn {
      background: #0f0;
      color: #000;
      padding: 5px;
      text-align: right;
      cursor: pointer;
    }

    .loader {
      width: 40px;
      height: 40px;
      border: 4px solid #222;
      border-top: 4px solid #0f0;
      border-radius: 50%;
      margin: 20px auto;
      animation: spin 1s linear infinite;
    }

    @keyframes spin {
      to { transform: rotate(360deg); }
    }

    @keyframes fadeIn {
      from { opacity: 0; transform: scale(0.9); }
      to { opacity: 1; transform: scale(1); }
    }

    .recommendations, .preview {
      background: #111;
      margin-top: 20px;
      padding: 10px;
      border: 1px solid #0f0;
    }

    .recommendations ul {
      list-style: none;
      padding: 0;
    }

    .recommendations li {
      margin: 5px 0;
      color: #0f0;
      cursor: pointer;
    }

    .thumbnail {
      display: flex;
      align-items: center;
      gap: 10px;
      margin-top: 10px;
    }

    .thumbnail img {
      width: 100px;
      border: 1px solid #0f0;
    }

    .thumbnail-info {
      flex: 1;
    }

    .caption-title {
      font-weight: bold;
    }
  </style>
</head>
<body>
  <h1>AI Video Popup Engine</h1>

  <input type="text" id="videoUrl" placeholder="Paste video link">
  <input type="number" id="popupCount" placeholder="Popup count">
  <button onclick="launchPopups()">Launch</button>

  <div class="preview" id="previewBox"></div>
  <div class="recommendations">
    <h3>Smart Recommendations:</h3>
    <ul id="recommendList"></ul>
  </div>

  <script>
    const captionsMock = [
      "This video talks about modern AI trends...",
      "An amazing clip showcasing tech evolution...",
      "Learn everything about secure coding here...",
      "Hacker tricks and tools you never knew!",
      "Explore the world of dark web (educational)"
    ];

    const recommendedLinks = [
      "https://www.youtube.com/watch?v=dQw4w9WgXcQ",
      "https://www.tiktok.com/@user/video/728128139476",
      "https://www.facebook.com/watch/?v=10203040506070",
    ];

    function launchPopups() {
      const url = document.getElementById('videoUrl').value.trim();
      const count = parseInt(document.getElementById('popupCount').value.trim());

      if (!url || isNaN(count) || count <= 0) {
        alert("Enter valid link and popup count.");
        return;
      }

      showPreview(url);

      for (let i = 0; i < count; i++) {
        setTimeout(() => createPopup(url), i * 300);
      }
    }

    function createPopup(url) {
      const embed = convertToEmbed(url);
      const popup = document.createElement('div');
      popup.className = 'popup';

      const closeBtn = document.createElement('div');
      closeBtn.className = 'close-btn';
      closeBtn.innerText = "âœ– Close";
      closeBtn.onclick = () => popup.remove();

      const loader = document.createElement('div');
      loader.className = 'loader';

      popup.appendChild(closeBtn);
      popup.appendChild(loader);
      document.body.appendChild(popup);

      setTimeout(() => {
        popup.removeChild(loader);
        const iframe = document.createElement('iframe');
        iframe.src = embed;
        iframe.allow = "autoplay; encrypted-media";

        const caption = document.createElement('div');
        caption.className = 'caption';
        caption.innerHTML = "<span class='caption-title'>AI Caption:</span> " +
          captionsMock[Math.floor(Math.random() * captionsMock.length)];

        popup.appendChild(iframe);
        popup.appendChild(caption);
      }, 1500);
    }

    function convertToEmbed(url) {
      if (url.includes("youtube.com/watch?v=")) {
        const id = url.split("v=")[1].split("&")[0];
        return `https://www.youtube.com/embed/${id}?autoplay=1&mute=1`;
      }

      if (url.includes("youtu.be/")) {
        const id = url.split("youtu.be/")[1];
        return `https://www.youtube.com/embed/${id}?autoplay=1&mute=1`;
      }

      if (url.includes("tiktok.com")) {
        const match = url.match(/video\/(\d+)/);
        if (match) return `https://www.tiktok.com/embed/v2/${match[1]}`;
      }

      if (url.includes("facebook.com")) {
        return `https://www.facebook.com/plugins/video.php?href=${encodeURIComponent(url)}&autoplay=1&mute=1`;
      }

      return url;
    }

    function showPreview(url) {
      const preview = document.getElementById('previewBox');
      preview.innerHTML = "<h3>Video Preview:</h3>";

      const thumb = document.createElement('div');
      thumb.className = 'thumbnail';

      const img = document.createElement('img');
      img.src = getThumbnail(url);

      const info = document.createElement('div');
      info.className = 'thumbnail-info';
      info.innerHTML = "<strong>Title:</strong> " + generateFakeTitle(url);

      thumb.appendChild(img);
      thumb.appendChild(info);
      preview.appendChild(thumb);
    }

    function getThumbnail(url) {
      if (url.includes("youtube.com") || url.includes("youtu.be")) {
        const id = url.includes("v=") ? url.split("v=")[1].split("&")[0] : url.split("youtu.be/")[1];
        return `https://img.youtube.com/vi/${id}/0.jpg`;
      }
      return "https://via.placeholder.com/100x75?text=Preview";
    }

    function generateFakeTitle(url) {
      if (url.includes("youtube")) return "Awesome YouTube Video!";
      if (url.includes("tiktok")) return "Trending TikTok Clip";
      if (url.includes("facebook")) return "Facebook Exclusive Footage";
      return "Unknown Media";
    }

    window.onload = () => {
      const list = document.getElementById("recommendList");
      recommendedLinks.forEach(link => {
        const li = document.createElement('li');
        li.innerText = link;
        li.onclick = () => {
          document.getElementById('videoUrl').value = link;
          showPreview(link);
        };
        list.appendChild(li);
      });
    }
  </script>
</body>
</html>
